{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrfmiddlewaretoken" content="{{ csrf_token }}">
    <title>{{ restaurant.name }} Menu</title>
    <link rel="stylesheet" href="{% static 'menu3/main.css' %}">
    <script src="{% static 'menu3/main.js' %}" defer></script>
</head>
<body>

    <!-- Navbar for categories -->
    <div class="navbar">
        {% for category in categories %}
            <a href="#{{ category.name }}">{{ category.name }}</a>
        {% endfor %}
    </div>

    <!-- Meals Display -->
    {% for category_name, meal_list in meals.items %}
        <div class="meal-section" id="{{ category_name }}">
            <h1>{{ category_name }}</h1>
            {% if meal_list %}
                <div class="meal-items">
                    {% for meal in meal_list %}
                        <div class="meal-item" onclick="showMealDetails('{{ meal.name }}', '{{ meal.title }}', '{{ meal.price }}', '{{ meal.description|escapejs }}', '{{ meal.image.url }}')">
                            <img src="{{ meal.image.url }}" alt="{{ meal.name }}">
                            <div class="meal-name">{{ meal.name }}</div>
                            <p>{{ meal.title }}</p>
                            <p>Price: {{ meal.price }} sum</p>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p>No meals available for this category.</p>
            {% endif %}
        </div>
    {% endfor %}

    <!-- Modal for meal details -->
    <div id="mealModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <img id="mealImage" src="" alt="Meal Image" class="meal-image">
            <h2 id="mealName"></h2>
            <p id="mealTitle"></p>
            <p id="mealDescription"></p>
            <p id="mealPrice"></p>

            <!-- Quantity controls inside the modal -->
            <div class="meal-count">
                <button class="count-btn" onclick="decreaseCount()">-</button>
                <span id="mealCount">0</span>
                <button class="count-btn" onclick="increaseCount()">+</button>
            </div>

            <button id="addToCartButton" onclick="addToCart()">Add to Cart</button>
        </div>
    </div>

    <!-- Cart modal (for full-screen cart view) -->
    <div id="cart" class="modal">
        <div id="cart-modal-content">
            <span id="closeCart" class="close" onclick="closeCart()">&times;</span> <!-- Close cart 'X' button -->
            <h3>Your Cart</h3>
            <ul id="cartItems"></ul>
            <!-- Confirm Order Button (Yellowish color) -->
            <button id="confirmOrderButton" class="confirm-order-btn" onclick="confirmOrder()">Confirm Order</button>
        </div>
    </div>

    <!-- Basket icon -->
    <div id="cart-icon" onclick="viewCart()">
        <img src="{% static 'menu3/basket.png' %}" alt="Cart">
        <span id="cart-count">0</span> <!-- Display the count of items in the cart -->
    </div>

</body>
</html>
